\section{Constant-Round and Blind $\QPIP_1$ protocol for $\SampBQP$}

We now present a constant-round, blind, and verifiable delegation scheme for $\SampBQP$ as an application of our $\QPIP_0$ construction for $\SampBQP$,
which we achieve by using the homomorphic encryption scheme from \cite{mahadev_qfhe} together with our construction.

\subsection{Our Delegation Protocol}

Now we compile our $\QPIP_1$ protocol (\cref{ProtoQPIP1}) using the quantum homomorphic encryption $\mathsf{QHE}$ from \cref{decodeMeasureOrder} in the same way as what we did for our blind $\BQP$ delegation protocol (\cref{proto:BlindBQP}) in \cref{sec:BlindBQP}.

\begin{protocol}{Compiling \cref{ProtoQPIP1} using $\mathsf{QHE}$}
	\label{proto:QPIP1Samp}
	\begin{enumerate}
		\item The verifier runs $\mathsf{QHE.keygen}(1^\lambda, 1^L)$ where $L$ is the depth of circuit corresponding to the honest prover's action in \cref{ProtoQPIP1}
		\item The verifier encrypts its input and runs \cref{ProtoQPIP1} with the prover homomorphically
		\item The verifier measures the incoming ciphertext according to \cref{decodeMeasureOrder}
		\item The verifier decodes the measurement results to get its output
	\end{enumerate}
\end{protocol}

\begin{thm}
	\cref{proto:QPIP1Samp} has the same completeness and soundness guarantees as \cref{ProtoQPIP1}
\end{thm}
\begin{proof}
	A honest prover still gets accepted with overwhelming probability by the correctness of $\mathsf{QHE}$. \Ethan{Not sure if too hand-wavy}

	As for soundness, a cheating prover cannot do better under this compiliation, since each message still decodes to some plaintext.

	In other words, anything a cheating prover can do after the compiliation, there exists a corresponding strategy in the version before.
	\Ethan {Ahhhh this is not rigorous at all}
\end{proof}

\begin{thm}
	\cref{proto:QPIP1Samp} is IND-CPA secure.
\end{thm}
\begin{proof}
	The only thing the prover gets is $\mathsf{QHE.Enc}_{pk}(x)$, $pk$, and $evk$. So this follows directly from the security of $\mathsf{QHE}$.
\end{proof}
