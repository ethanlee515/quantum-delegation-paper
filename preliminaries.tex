\section{Preliminaries}

\Ethan{Check that the quantifiers are all there}

\subsection{Notations}

Let $\mathcal{B}$ be the Hilbert space corresponding to one qubit. Let $H:\mathcal{B}^{\otimes n}\rightarrow\mathcal{B}^{\otimes n}$ be Hermitian matrices. We use $H\geq0$ to denote $H$ being positive semidefinite. Let $\lambda(H)$ be the smallest eigenvalue of $H$. The ground states of $H$ are the eigenvectors corresponding to $\lambda(H)$. For matrix $H$ and subspace $S$, let $H\big|_S=\Pi_S H \Pi_S$, where $\Pi_S$ is the projector onto the subspace $S$. For a $T$-qubit Hilbert space, let the state $\ket{\widehat{t}}=\ket{1}^{\otimes t}\otimes \ket{0}^{{\otimes (T-t)}}$.
For $n$-qubit states $\rho_1, \rho_2\in\cB^{\otimes n}$,
we write $F(\rho_1, \rho_2)=\left(\tr\sqrt{\sqrt{\rho_1}\rho_2\sqrt{\rho_1}}\right)^2$ for the fidelity between $\rho_1$ and $\rho_2$.
We write $\norm{\rho_1-\rho_2}_{tr}=\frac{1}{2}\norm{\rho_1-\rho_2}_1$ for the trace distance between $\rho_1$ and $\rho_2$,
We have $\norm{\rho_1-\rho_2}_{tr}\leq\sqrt{1-F(\rho_1, \rho_2)}$.
We say $\rho_1$ and $\rho_2$ are $\varepsilon$-close if $F(\rho_1, \rho_2)\leq\varepsilon$.
For two distributions $f_1$ and $f_2$ over the same finite domain $X$, we write $\norm{f_1-f_2}_{TV}=\frac{1}{2}\sum_{x\in X}\abs{f_1(x)-f_2(x)}$ for their total variation distance,
and we say $f_1$ and $f_2$ are $\varepsilon$-close if $\norm{f_1-f_2}_{TV}\leq\varepsilon$.
We write $x\xleftarrow{\$}X$ when $x$ is sampled uniformly at random from the set $X$.

\begin{definition} [quantum-classical channels]
	\label{def:QCChannel}
	A quantum measurement is given by a set of matrices $\set{M_k}$ such that $M_k\geq0$ and $\sum_k M_k=\id$.
	We associate to any measurement a map $\Lambda(\rho)=\sum_k \tr(M_k\rho)\ket{k}\bra{k}$
	with $\set{\ket{k}}$ an orthonormal basis.
	This map is also called a \emph{quantum-classical channel}.
\end{definition}

The phase gate and Pauli matrices are the following matrices.

\begin{definition}
	$P(i)=\begin{pmatrix}1&0\\0&i\end{pmatrix}$,
	$X=\begin{pmatrix}0&1\\1&0\end{pmatrix}$,
	$Y=\begin{pmatrix}0&-i\\i&0\end{pmatrix}$,
	$Z=\begin{pmatrix}1&0\\0&-1\end{pmatrix}$
\end{definition}

\subsection{Sampling Problems}

We define the sampling version of $\BQP$ based on \cite{aaronson_2013}.

\begin{definition} [sampling problem]
	A \emph{sampling problem} is a collection of probability distributions $(D_x)_{x\in\set{0, 1}^*}$, one for each input string $x\in\set{0,1}^n$, where $D_x$ is a distribution over $\set{0,1}^{m(n)}$ for some fixed polynomial $m$.
\end{definition}

\begin{definition} [$\SampBQP$]
	$\SampBQP$ is the class of sampling problems $\left(D_x\right)_{x\in\set{0, 1}^*}$ that can be (approximately) sampled by polynomial-size uniform quantum circuits. Namely, there exists a Turing machine $M$ such that for every $n \in \bbN$ and $\varepsilon \in (0,1)$, $M(1^n, 1^{1/\eps})$ outputs a quantum circuit $C$ in $\poly(n, 1/\varepsilon)$ time such that for every $x \in \zo^n$, the output of $C(x)$ (measured in standard basis) is $\eps$-close to $D_x$.
\end{definition}


\subsection{Computational Indistinguishability}

\begin{definition}[quantum computationally indistinguishable]\label{def:comp-indis}
\hannote{move later}
Let  $D_1$ and $D_2$ be distributions over $n$-bit string.  We say $D_1$ and $D_2$  are $\eps$-Q-computationally indistinguishable if for all quantum circuit $A$ of size $\poly(n)$, $$\L\|\Pr[A({D_1})=1]-\Pr[A({D_2})=1]  \R\| \leq \eps,$$  where $A(D_1)$ means $A$ takes \emph{one} sample from $D_1$ as part of its input. We also denote "$D_1$ and $D_2$  are $\eps$-Q-computationally indistinguishable" as 
$$ \norm{D_1 - D_2}_q \leq \eps.$$
And "$D_1$ and $D_2$  are not $\eps$-Q-computationally indistinguishable" as 
$$ \norm{D_1 - D_2}_q > \eps.$$
\end{definition}
%Let $O^{D_1}$ and $O^{D_2}$ be oracles giving samples from $D_1$ and $D_2$.

\begin{rmk}
We extend the definition of computational distance to a subnormalized distribution  $D$  by assuming $A(D)=0$ when $A$ fail to draw a sample from $D$.
\end{rmk}

\begin{rmk}\label{rmk:trace-to-comp}
If $\norm{D_1-D_2}_1\leq \eps$, $D_1$ and $D_2$ are $\eps$-Q-computationally indistinguishable.
\end{rmk}

\begin{lem}[triangle inequality for computational distance] \label{lem:computational-triangle0}
    Let $D_1$, $D_2$, and $D_3$ be three distributions such that 
    \begin{align}
        \norm{D_1 -D_2}_q &\leq \eps \\ 
        \norm{D_2 -D_3}_q &\leq \eps'. 
    \end{align}
    We have 
    \begin{align}
        \norm{D_1 -D_3}_q &\leq \eps+\eps'
    \end{align}
\end{lem}
\begin{proof}
For all quantum circuits $A$ with size $\poly(n)$, we have 
\begin{align}
    \norm{\Pr[A({D_1})=1]-\Pr[A({D_2})=1]} \leq& \eps \\
    \norm{\Pr[A({D_2})=1]-\Pr[A({D_3})=1]} \leq& \eps',  
\end{align}
so 
\begin{align}
    &\norm{\Pr[A({D_1})=1]-\Pr[A({D_3})=1]} \nn \\
    =& \norm{\Pr[A({D_1})=1]-\Pr[A({D_2})=1]+\Pr[A({D_2})=1]-\Pr[A({D_3})=1]} \nn \\
    \leq&  \norm{\Pr[A({D_1})=1]-\Pr[A({D_2})=1]} +\norm{\Pr[A({D_2})=1]-\Pr[A({D_3})=1]} \nn \\
    =& \eps +\eps' \nn
\end{align}

\end{proof}



\subsection{Quantum Prover Interactive Protocols (QPIP)}

\Ethan{TODO, lower priority: define protocols}

We model the interaction between a (almost classical) client and a quantum server following \cite{FOCS:Mahadev18a}.

\begin{definition}
	A protocol $\Pi=(P, V)$ is said to be in $\QPIP_\tau$ if it satisfies the following properties:
	\begin{itemize}
		\item $P$ is a $\BQP$ \Ethan{wording; quantum poly time?} machine, which also has access to a quantum channel that can transmit $\tau$ qubits to the verifier per use.
		\item $V$ is a hybrid machine of a classical part and a limited quantum part. The classical part is a $\BPP$ machine. The quantum part is a register of $\tau$ qubits, on which the verifier can perform arbitrary quantum operations and which has access to a quantum channel which can transmit $\tau$ qubits. At any given time, the verifier is not allowed to possess more than $\tau$ qubits. The interaction between the quantum and classical parts of the verifier is the usual one: the classical part controls which operations are to be performed on the quantum register, and outcomes of measurements of the quantum register can be used as input to the classical part.
		\item There is also a classical communication channel between the prover and the verifier, which can transmit polynomially many bits to either direction.
	\end{itemize}
\end{definition}

\Ethan{Sec. param. should be 1st param}

\begin{definition}
	Let $\Pi=(P, V)$ be a $\QPIP_\tau$ protocol.
	We say it is a prototol for a $\BQP$ language $L$ with completeness error $c(\cdot)$ and soundness error $s(\cdot)$ if the following holds.
\begin{itemize}
		\item On public inputs $1^\lambda$ and $x\in\zo^*$, the verifier outputs either $\Acc$ or $\Rej$.
		\item (Completeness): For all security parameter $\lambda\in\bbN$ and $x\in\zo^{\poly(\lambda)}$, if $x\in L$ then
		$\Pr\left[(P, V)(x, 1^\lambda)=\Rej\right]<c(\lambda)$.
		\item (Soundness): For all cheating $\BQP$ prover $P^*$, sufficiently large security parameter $\lambda\in\bbN$, and $x\in\zo^{\poly(\lambda)}$, if $x \notin L$ then $\Pr\left[(P, V)(x, 1^\lambda)=\Rej\right]<s(\lambda)$.
	\end{itemize}
\end{definition}

\begin{definition}
	\label{dfn:stats-secure-proto-sampbqp}
	Let $\Pi=(P, V)$ be a $\QPIP_\tau$ protocol.
	We say it is a protocol for the sampling problem $(D_x)_{x\in\zo^*}$ with completeness error $c$ and statistical (resp., computational) soundness if the following holds.
	\begin{itemize}
		\item On public inputs $1^\lambda$, $1^{1/\varepsilon}$, and $x\in\zo^n$, $V$ outputs $(d, z)$ where $d\in\set{\Acc, \Rej}$. If $d=\Acc$ then $z\in\zo^{m(n)}$, otherwise $z=\bot$.
		\item (Completeness):
			For all security parameter $\lambda\in\bbN$, accuracy parameter $\varepsilon=\frac{1}{\poly(\lambda)}$, and $x\in\zo^{\poly(\lambda)}$, 
			Let $(d, z)\leftarrow(P, V)(1^\lambda, 1^{1/\varepsilon}, x)$, then $d=\Rej$ with probability at most $c(\lambda)$.
		\item (Statistical soundness): For all cheating prover $P^*$,
			sufficiently large $\lambda\in\bbN$, accuracy parameter $\varepsilon=\frac{1}{\poly(\lambda)}$, and $x\in\zo^{\poly(\lambda)}$, 
			consider the following experiment:
			\begin{itemize}
				\item Let $(d, z)\leftarrow(P^*, V)(x, 1^{1/\varepsilon}, 1^\lambda)$.
				\item Define $z_{ideal}$ by
				$$\begin{cases}
					z_{ideal}=\bot & \text{if } d=\Rej\\
					z_{ideal}\leftarrow D_x & \text{if } d=\Acc
				\end{cases}$$.
			\end{itemize}
			It holds that $\norm{(d,z)-(d,z_{ideal})}_{TV}\leq\varepsilon$. 
		\item (Computational soundness): Define $d, z, z_{ideal}$ same as above.
			It holds that for all $\BQP$ distinguisher $D$,
			$\abs{\Pr[D(1^{\lambda}, d,z) = 1] - \Pr[D(1^{\lambda}, d,z_{ideal}) = 1]} \leq \varepsilon $
	\end{itemize}
\end{definition}

We define blindness of a protocol as follows. \Ethan{Input x is private input now... the rest are still common input... etc.}

\begin{definition}
	Let $(P, V)$ be an interactive protocol with security parameter $\lambda$. \Ethan{Define the version with eps, say that it's fine without eps for BQP} \Ethan{TODO Quantify cheating prover}
	Let $\lambda$ be a security parameter.
	Then it is \emph{blind} if the following ensembles are computationally indistinguishable over $\lambda$:
	\begin{itemize}
		\item $\set{\View_{P^*}(P^*, V(x))(1^\lambda)}_{\lambda\in\bbN, x\in\zo^n}$
		\item $\set{\View_{P^*}(P^*, V(0))(1^\lambda)}_{\lambda\in\bbN, x\in\zo^n}$
	\end{itemize}
\end{definition}

\subsection{Chernoff bound}

\begin{thm}
\label{thm:Chernoff}
Let $X=\sum_{i=1}^n X_i$ where $X_i$ are independent Bernoulli trials, and $\mu=\E[X]$.
Then for all $0<\delta<1$,
$$P[\abs{X-\mu}\geq\delta\mu]\leq2e^{-\frac{\mu\delta^2}{3}}.$$
\end{thm}

\Ethan{Proj. lemma and de Finetti thm. were moved}

\subsection{Quantum Homomorphic Encryption Schemes}

\Ethan{Just define QHE}

\def\QHE{\mathsf{QHE}}
\def\QGen{\mathsf{QHE.Keygen}}
\def\QEnc{\mathsf{QHE.Enc}}
\def\QEval{\mathsf{QHE.Eval}}
\def\QDec{\mathsf{QHE.Dec}}

We use the quantum fully homomorphic encryption scheme given in \cite{mahadev_qfhe} which is compatible with our use of a classical client. We start by presenting the definition of a homomorphic encryption scheme:
\begin{definition}
    \Ethan{Do more copying}
	A leveled homomophic encryption scheme is tuple of algorithms \linebreak $\mathsf{HE}=(\mathsf{HE.Keygen}, \mathsf{HE.Enc}, \mathsf{HE.Dec}, \mathsf{HE.Eval})$ with the following descriptions:
	\begin{itemize}
		\item $\mathsf{HE.Keygen}(1^\lambda, 1^L)\rightarrow(pk, sk)$
		\item $\mathsf{HE.Enc}_{pk}(\mu)\rightarrow c$
		\item $\mathsf{HE.Dec}_{sk}(c)\rightarrow \mu^*$
		\item $\mathsf{HE.Eval}_{pk}(f, c_1, \ldots, c_l)\rightarrow c_f$
	\end{itemize}
\end{definition}

$\mathsf{HE}$ also satisfies, with overwhelming probability in $\lambda$, that
$$\mathsf{HE.Dec}_{sk}(\mathsf{HE.Eval}_{pk}(f, c_1, \ldots, c_l))=f(\mathsf{HE.Dec}_{sk}(c_1),\ldots,\mathsf{HE.Dec}_{sk}(c_l))$$
where $f$ is specified by a circuit of depth at most $L$.

\Ethan{To be pedantic, the above doesn't imply Dec undoes Enc even if we sub in $f=\id$.}

\Ethan{Maybe add correctness}

We also recall the security definition for a FHE scheme.

\begin{definition}
	A FHE scheme $\mathsf{HE}$ is IND-CPA secure if, for any polynomial time adversary $\cA$, there exists a negligible function $\mu(\cdot)$ such that
	$$\abs{Pr[\cA(pk, \mathsf{HE.Enc}_{pk}(0))=1]-Pr[\cA(pk, \mathsf{HE.Enc}_{pk}(1))=1]}\leq\mu(\lambda)$$
	where $(pk, sk)\leftarrow\mathsf{QHE.Keygen}(1^\lambda)$
\end{definition}

The quantum homomorphic encryption scheme $\mathsf{QHE}$ from \cite{mahadev_qfhe} has additional properties that facilitate the use of classical clients.

\begin{definition}
	we call a quantum homomorphic encryption scheme \emph{classical-friendly} if it has the following properties:
	\begin{itemize}
		\item $\QGen$ produces classical keys
		\item In the case where the plaintext is classical, $\QEnc$ can be done classically.
		\item Its ciphertext can be homomorphically measured, after which $\QDec$ can also be done classically. \Ethan{Underlying msg is classical = ct is classical = can be classical decrypted}
	\end{itemize}
\end{definition}

\begin{theorem} [Theorem 1.1 in \cite{mahadev_qfhe}]
	Under the assumption that the learning with errors problem with superpolynomial noise ratio is computationally intractable for an efficient quantum machine,
	there exists a classical-friendly quantum homomorphic encryption scheme.
\end{theorem}
